<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Exercise 1</title>
</head>
<body>
    
    <script>
        var users = [{
                'username': 'admin',
                'password': 'qwerty12345'
            },
            {
                'username': 'user',
                'password': 'user1_pass'
            }
            ]

            function userLogin(givenUsername, givenPassword) {
                return new Promise((resolve,reject)=>{
                    saveData();
                    let storageUsers=  JSON.parse(localStorage.getItem("userInfo"));

                    for (i = 0; i < storageUsers.length; i++) {
                //        if(users[i].username == givenUsername && users[i].password == givenPassword) {
                         if(storageUsers(i).username==givenUsername &&  storageUsers(i).password==givenPassword ){
                            showInfo();
                            resolve(`User with username ${givenUsername} found.`);
                        }
                    }
                    var error=new Error("User was not found");
                    reject(error);

                })
            } 

            // function fileDownload(){
            //     return new Promise((resolve,reject)=>{
            //         let link = "https://www.w3.org/WAI/ER/tests/xhtml/testfiles/resources/pdf/dummy.pdf"
            //         resolve(link);
            //     })
            // }


            // function redirectHome(){
            //     return new Promise((resolve,reject)=>{
            //         setTimeout(function () {
            //             console.log('redirecting...');
            //             location.replace("https://www.w3schools.com");
            //             resolve("successfully redirected");
            //       }, 3000);
            //     });
            // }

            function saveData(){
                let strUsers=JSON.stringify(users);
                localStorage.setItem('userInfo',strUsers);
                let x=localStorage.getItem("userInfo");
                console.log(x);
            }

            function showInfo(){
                let storage=localStorage;
                for(let i=0;i<storage.length;i++){
                    console.log(storage.key(i)+" : "+storage.getItem(storage.key(i)));
                }
            }




        function run(){
            let user=prompt("username");
            let pass=prompt("pass");

            const promise = userLogin(user, pass).then(
                function(fulfilled) {
                     console.log(fulfilled);
                     
                });
        }
            
      


    </script>
</body>
</html>